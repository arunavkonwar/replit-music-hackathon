var context,source,sourceJs,analyser,url="data/arunav-konwar-whats-on-her-mind.mp3",array=new Array,boost=0,interval=window.setInterval(function(){$("#loading_dots").text().length<3?$("#loading_dots").text($("#loading_dots").text()+"."):$("#loading_dots").text("")},500);try{context="function"==typeof webkitAudioContext||"webkitAudioContext"in window?new webkitAudioContext:new AudioContext}catch(t){$("#info").text("Web Audio API is not supported in this browser")}var request=new XMLHttpRequest;function displayTime(t){if(t<60)return"0:"+(t<10?"0"+t:t);var e=Math.floor(t/60);return e+":"+((t-=60*e)<10?"0"+t:t)}function play(){$("#play").fadeOut("normal",function(){$(this).remove()}),source.start(0)}request.open("GET",url,!0),request.responseType="arraybuffer",request.onload=function(){context.decodeAudioData(request.response,function(t){t?((sourceJs=context.createScriptProcessor(2048,1,1)).buffer=t,sourceJs.connect(context.destination),(analyser=context.createAnalyser()).smoothingTimeConstant=.6,analyser.fftSize=512,(source=context.createBufferSource()).buffer=t,source.loop=!0,source.connect(analyser),analyser.connect(sourceJs),source.connect(context.destination),sourceJs.onaudioprocess=function(t){array=new Uint8Array(analyser.frequencyBinCount),analyser.getByteFrequencyData(array),boost=0;for(var e=0;e<array.length;e++)boost+=array[e];boost/=array.length},$("#info").fadeOut("normal",function(){$(this).html('<div id="artist"><a class="name" href="https://soundcloud.com/arunavkonwar" target="_blank">Arunav Konwar</a><br /><a class="song" href="https://soundcloud.com/arunavkonwar/whats-on-her-mind" target="_blank">Six shooter</a><br /></div><div><img src="data/arunav-konwar.jpg" width="58" height="58" /></div>')}).fadeIn(),clearInterval(interval),$("body").append($('<div onclick="play();" id="play" style="width: '+$(window).width()+"px; height: "+$(window).height()+'px;"><div id="play_link"></div></div>')),$("#play_link").css("top",$(window).height()/2-$("#play_link").height()/2+"px"),$("#play_link").css("left",$(window).width()/2-$("#play_link").width()/2+"px"),$("#play").fadeIn()):$("#info").text("Error decoding file data")},function(t){$("#info").text("Decoding error:"+t)})},request.onerror=function(){$("#info").text("buffer: XHR error")},request.send(),$(window).resize(function(){1===$("#play").length&&($("#play").width($(window).width()),$("#play").height($(window).height()),1===$("#play_link").length&&($("#play_link").css("top",$(window).height()/2-$("#play_link").height()/2+"px"),$("#play_link").css("left",$(window).width()/2-$("#play_link").width()/2+"px")))});